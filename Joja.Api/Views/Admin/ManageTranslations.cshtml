@model IEnumerable<Joja.Api.Models.UiTranslation>
@{
    ViewData["Title"] = "Manage Translations";
}

<div class="container" style="margin-top: 50px;">
    <h1 class="brand-font">Manage Translations</h1>
    <a asp-action="Index" class="btn-primary" style="margin-bottom: 20px;">Back to Dashboard</a>
    
    <table class="table" style="width: 100%; margin-top: 20px; border-collapse: collapse;">
        <thead>
            <tr style="background-color: var(--joja-nude);">
                <th style="padding: 10px; text-align: left;">Key</th>
                <th style="padding: 10px; text-align: left;">Language</th>
                <th style="padding: 10px; text-align: left;">Translation</th>
                <th style="padding: 10px; text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model) {
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 10px;">@item.Key</td>
                    <td style="padding: 10px;">
                        <span class="badge" style="background: @(item.Language == "ar" ? "#4CAF50" : "#2196F3"); color: white; padding: 4px 8px; border-radius: 4px;">
                            @item.Language.ToUpper()
                        </span>
                    </td>
                    <td style="padding: 10px;">
                        <input type="text" id="trans-@item.Id" value="@item.Value" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" dir="@(item.Language == "ar" ? "rtl" : "ltr")" />
                    </td>
                    <td style="padding: 10px; text-align: center;">
                        <button onclick="saveTranslation(@item.Id)" class="btn-joja-dark" style="padding: 6px 12px; font-size: 0.8rem;">Save</button>
                        <span id="status-@item.Id" style="margin-left: 10px; font-size: 0.8rem;"></span>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

<script>
function saveTranslation(id) {
    const input = document.getElementById('trans-' + id);
    const value = input.value;
    const status = document.getElementById('status-' + id);
    
    status.textContent = 'Saving...';
    status.style.color = '#666';

    const formData = new FormData();
    formData.append('id', id);
    formData.append('value', value);

    fetch('/Admin/UpdateTranslation', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            status.textContent = '✓ Saved';
            status.style.color = '#4CAF50';
            setTimeout(() => status.textContent = '', 2000);
        } else {
            status.textContent = '✗ Error';
            status.style.color = '#f44336';
        }
    })
    .catch(err => {
        status.textContent = '✗ Error';
        status.style.color = '#f44336';
    });
}
</script>
